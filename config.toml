# === 오케스트레이터 설정 ===
[orchestrator]
agent = "claude-opus"           # 메인 CLI로 열릴 에이전트
prompt_file = "prompts/orchestrator.md"

# === 에이전트 정의 (CLI 방식) ===
# 모델별로 에이전트를 정의하면 역할별 모델 선택 가능!

# Claude Opus - High effort (계획, 복잡한 분석)
[agents.claude-opus-high]
type = "cli"
command = "claude"
model = "opus"
effort = "high"
args = ["-p", "{prompt}", "--print", "--effort", "high"]
timeout = 600

# Claude Opus - Medium effort (일반 작업)
[agents.claude-opus]
type = "cli"
command = "claude"
model = "opus"
effort = "medium"
args = ["-p", "{prompt}", "--print", "--effort", "medium"]
timeout = 300

# Claude Opus - Low effort (빠른 응답)
[agents.claude-opus-low]
type = "cli"
command = "claude"
model = "opus"
effort = "low"
args = ["-p", "{prompt}", "--print", "--effort", "low"]
timeout = 120

[agents.claude-sonnet]
type = "cli"
command = "claude"
model = "sonnet"
args = ["-p", "{prompt}", "--print"]
timeout = 300

# Haiku - 문서 읽기, 요약, 빠른 처리용
[agents.claude-haiku]
type = "cli"
command = "claude"
model = "haiku"
args = ["-p", "{prompt}", "--print"]
timeout = 60

# Haiku with web search (문서 검색용)
[agents.claude-haiku-web]
type = "cli"
command = "claude"
model = "haiku"
args = ["-p", "{prompt}", "--print", "--allowedTools", "WebSearch,WebFetch"]
timeout = 90

[agents.codex]
type = "cli"
command = "codex"
model = "gpt-5.2"
reasoning_effort = "medium"
args = ["exec", "{prompt}", "--full-auto", "--skip-git-repo-check", "-c", "model_reasoning_effort=\"{reasoning_effort}\""]
timeout = 300

[agents.codex-gpt5]
type = "cli"
command = "codex"
model = "gpt-5.2"
reasoning_effort = "high"
args = ["exec", "{prompt}", "--full-auto", "--skip-git-repo-check", "-c", "model_reasoning_effort=\"{reasoning_effort}\""]
timeout = 300

# Codex for code writing (gpt-5.2-codex model)
[agents.codex-coder]
type = "cli"
command = "codex"
model = "gpt-5.2-codex"
reasoning_effort = "high"
args = ["exec", "{prompt}", "--full-auto", "--skip-git-repo-check", "-c", "model_reasoning_effort=\"{reasoning_effort}\""]
timeout = 600

# Claude Opus with web search + high effort (플래너용)
[agents.claude-web]
type = "cli"
command = "claude"
model = "opus"
effort = "high"
args = ["-p", "{prompt}", "--print", "--allowedTools", "WebSearch,WebFetch", "--effort", "high"]
timeout = 600

# === 역할별 설정 (에이전트+모델 조합 선택!) ===
[roles.planner]
agent = "claude-web"           # 계획 (웹 검색 가능)
prompt_file = "prompts/planner.md"

[roles.plan_validator]
agent = "codex-gpt5"            # 검증은 Codex GPT-5.2
prompt_file = "prompts/plan_validator.md"

[roles.implementer]
agent = "claude-opus-high"    # 구현 (Opus high effort)
prompt_file = "prompts/implementer.md"

[roles.code_reviewer]
agent = "codex-coder"          # 리뷰 (gpt-5.2-codex)
prompt_file = "prompts/code_reviewer.md"

[roles.fixer]
agent = "claude-opus-high"    # 수정 (Opus high effort)
prompt_file = "prompts/fixer.md"

# === 유틸리티 역할 (Haiku - 빠르고 저렴) ===
[roles.doc_reader]
agent = "claude-haiku"        # 문서 읽기/요약
prompt_file = "prompts/doc_reader.md"

[roles.db_reader]
agent = "claude-haiku"        # SQLite/DB 읽기
prompt_file = "prompts/db_reader.md"

[roles.summarizer]
agent = "claude-haiku"        # 컨텍스트 요약 (압축용)
prompt_file = "prompts/summarizer.md"

[roles.researcher]
agent = "claude-haiku-web"    # 웹 검색 + 문서 수집
prompt_file = "prompts/researcher.md"

# === 워크플로우 ===
[[workflow.steps]]
role = "planner"
output = "plan.json"

[[workflow.steps]]
role = "plan_validator"
input = "plan.json"
on_fail = "goto:planner"

[[workflow.steps]]
role = "implementer"
input = "plan.json"
per_task = true

[[workflow.steps]]
role = "code_reviewer"
per_task = true
on_fail = "goto:fixer"

[[workflow.steps]]
role = "fixer"
on_success = "goto:code_reviewer"

# === 기타 설정 ===
[retry_policy]
max_retries = 3
retry_delay = 5

[judge]
# AI-based verification (language-agnostic)
# code_reviewer role handles all verification:
# - Spec compliance
# - Test coverage (if tests exist)
# - Scope compliance (only assigned files modified)
# - Code quality (patterns, bugs, security)
# No hardcoded test commands - user's project determines testing approach
agent = "code_reviewer"
verify_scope = true       # Check git diff for file ownership violations
verify_specs = true       # Check implementation matches specs
