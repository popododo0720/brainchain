# Brainchain Configuration

# === Orchestrator ===
# When running `brainchain`, launches this agent's CLI directly
# Options: "claude", "codex", or any custom agent
[orchestrator]
agent = "claude"
prompt_file = "prompts/orchestrator.md"

# === Agents (CLI adapters) ===

# Claude (interactive orchestrator)
[agents.claude]
command = "claude"

# Codex (interactive orchestrator)
[agents.codex]
command = "codex"
reasoning_effort = "medium"

# Claude Opus - High effort (planning, complex analysis)
[agents.claude-opus-high]
command = "claude"
model = "opus"
args = ["-p", "{prompt}", "--print", "--permission-mode", "acceptEdits"]
timeout = 600

# Claude Opus - Medium effort (general tasks)
[agents.claude-opus]
command = "claude"
model = "opus"
args = ["-p", "{prompt}", "--print", "--permission-mode", "acceptEdits"]
timeout = 300

# Claude Opus - Low effort (quick responses)
[agents.claude-opus-low]
command = "claude"
model = "opus"
args = ["-p", "{prompt}", "--print", "--permission-mode", "acceptEdits"]
timeout = 120

# Claude Sonnet
[agents.claude-sonnet]
command = "claude"
model = "sonnet"
args = ["-p", "{prompt}", "--print", "--permission-mode", "acceptEdits"]
timeout = 300

# Claude Haiku - Fast/cheap (docs, summaries)
[agents.claude-haiku]
command = "claude"
model = "haiku"
args = ["-p", "{prompt}", "--print", "--permission-mode", "acceptEdits"]
timeout = 60

# Claude Haiku with web search
[agents.claude-haiku-web]
command = "claude"
model = "haiku"
args = ["-p", "{prompt}", "--print", "--permission-mode", "acceptEdits", "--allowedTools", "WebSearch,WebFetch"]
timeout = 90

# Claude Opus with web search (planner)
[agents.claude-web]
command = "claude"
model = "opus"
args = ["-p", "{prompt}", "--print", "--permission-mode", "acceptEdits", "--allowedTools", "WebSearch,WebFetch"]
timeout = 600

# Codex GPT-5.2
[agents.codex]
command = "codex"
model = "gpt-5.2"
reasoning_effort = "medium"
args = ["exec", "{prompt}", "--full-auto", "--skip-git-repo-check", "-c", "model_reasoning_effort=\"{reasoning_effort}\""]
timeout = 300

# Codex GPT-5.2 High effort
[agents.codex-gpt5]
command = "codex"
model = "gpt-5.2"
reasoning_effort = "high"
args = ["exec", "{prompt}", "--full-auto", "--skip-git-repo-check", "-c", "model_reasoning_effort=\"{reasoning_effort}\""]
timeout = 300

# Codex Coder (gpt-5.2-codex)
[agents.codex-coder]
command = "codex"
model = "gpt-5.2-codex"
reasoning_effort = "high"
args = ["exec", "{prompt}", "--full-auto", "--skip-git-repo-check", "-c", "model_reasoning_effort=\"{reasoning_effort}\""]
timeout = 600

# === Roles (agent + prompt combinations) ===

[roles.planner]
agent = "claude-web"
prompt_file = "prompts/planner.md"

[roles.plan_validator]
agent = "codex-gpt5"
prompt_file = "prompts/plan_validator.md"

[roles.implementer]
agent = "claude-opus-high"
prompt_file = "prompts/implementer.md"

[roles.code_reviewer]
agent = "codex-coder"
prompt_file = "prompts/code_reviewer.md"

[roles.fixer]
agent = "claude-opus-high"
prompt_file = "prompts/fixer.md"

# Utility roles (Haiku - fast/cheap)
[roles.doc_reader]
agent = "claude-haiku"
prompt_file = "prompts/doc_reader.md"

[roles.db_reader]
agent = "claude-haiku"
prompt_file = "prompts/db_reader.md"

[roles.summarizer]
agent = "claude-haiku"
prompt_file = "prompts/summarizer.md"

[roles.researcher]
agent = "claude-haiku-web"
prompt_file = "prompts/researcher.md"

# Exploration roles (cheap/fast search)
[roles.explore]
agent = "claude-haiku"
prompt_file = "prompts/explore.md"

[roles.librarian]
agent = "claude-haiku-web"
prompt_file = "prompts/librarian.md"

# === Workflow ===

[[workflow.steps]]
role = "planner"
output = "plan.json"

[[workflow.steps]]
role = "plan_validator"
input = "plan.json"
on_fail = "goto:planner"

[[workflow.steps]]
role = "implementer"
input = "plan.json"
per_task = true

[[workflow.steps]]
role = "code_reviewer"
per_task = true
on_fail = "goto:fixer"

[[workflow.steps]]
role = "fixer"
on_success = "goto:code_reviewer"

# === Execution Settings ===

[retry_policy]
max_retries = 3
retry_delay = 5

[parallel]
max_workers = 5

# === Session Management ===

[session]
enabled = true
auto_save = true
retention_days = 30
# db_path = "~/.config/brainchain/sessions.db"

[session.recovery]
auto_detect = true
prompt_resume = true

# === MCP (Model Context Protocol) ===
# Optional: Enable MCP servers for enhanced capabilities

[mcp]
enabled = false
connect_timeout = 10

# Example MCP server configuration:
# [mcp.servers.filesystem]
# enabled = true
# command = ["npx", "-y", "@anthropics/mcp-server-filesystem", "/path/to/dir"]
